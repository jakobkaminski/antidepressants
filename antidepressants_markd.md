Antidepressants and suicidal behaviour?
================
Jakob A. Kaminski
4 7 2019

## Intro

In 1990 Teicher et al. (1990) reported unexpected suicidal ideation in
depressed patients treated with fluoxetine. Since then, several studies
investigated suicide risk. A recent study by Hengartner et al. (2018)
performed a re-analysis of the FDA database and evaluated
newer-generation antidepressants and suicide risk in Randomized
Controlled Trials.

They refer to Khan et al 2018 who report decreased suicidylity in newer
generation antidepressants and no decreased suicidality as compared to
placebo.

Khan et al. calculate person person exposure year (PEY).

Hengartner et al. argue that suicides occur in the beginning of
treatment so PEY is not the apropriate analysis.

We critically review the literature and reanalyze the re-analysis.

This is the data from Hengartner et al. (2018) Of note, there is
considerable variance between the studies.

<table>

<thead>

<tr>

<th style="text-align:left;">

study

</th>

<th style="text-align:right;">

ADsuicides

</th>

<th style="text-align:right;">

ADparticipants

</th>

<th style="text-align:right;">

PLCsuicides

</th>

<th style="text-align:right;">

PLCparticipants

</th>

</tr>

</thead>

<tbody>

<tr>

<td style="text-align:left;">

Sertraline (1991)

</td>

<td style="text-align:right;">

2

</td>

<td style="text-align:right;">

2053

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

786

</td>

</tr>

<tr>

<td style="text-align:left;">

Paroxetine (1992)

</td>

<td style="text-align:right;">

5

</td>

<td style="text-align:right;">

2963

</td>

<td style="text-align:right;">

2

</td>

<td style="text-align:right;">

554

</td>

</tr>

<tr>

<td style="text-align:left;">

Venlafaxine (1993)

</td>

<td style="text-align:right;">

3

</td>

<td style="text-align:right;">

2181

</td>

<td style="text-align:right;">

1

</td>

<td style="text-align:right;">

451

</td>

</tr>

<tr>

<td style="text-align:left;">

Nefazodone (1994)

</td>

<td style="text-align:right;">

9

</td>

<td style="text-align:right;">

3496

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

875

</td>

</tr>

<tr>

<td style="text-align:left;">

Mirtazapine (1996)

</td>

<td style="text-align:right;">

8

</td>

<td style="text-align:right;">

2425

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

494

</td>

</tr>

<tr>

<td style="text-align:left;">

Venlafaxine ER (1997)

</td>

<td style="text-align:right;">

1

</td>

<td style="text-align:right;">

705

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

285

</td>

</tr>

<tr>

<td style="text-align:left;">

Citalopram (1998)

</td>

<td style="text-align:right;">

8

</td>

<td style="text-align:right;">

4168

</td>

<td style="text-align:right;">

1

</td>

<td style="text-align:right;">

691

</td>

</tr>

<tr>

<td style="text-align:left;">

Escitalopram (2002)

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

715

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

592

</td>

</tr>

<tr>

<td style="text-align:left;">

Duloxetine (2002)

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

2314

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

723

</td>

</tr>

<tr>

<td style="text-align:left;">

Desvenlafaxine (2008)

</td>

<td style="text-align:right;">

1

</td>

<td style="text-align:right;">

2667

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

803

</td>

</tr>

<tr>

<td style="text-align:left;">

Trazodone ER (2010)

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

202

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

204

</td>

</tr>

<tr>

<td style="text-align:left;">

Vilazodone (2011)

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

2177

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

997

</td>

</tr>

<tr>

<td style="text-align:left;">

Levomilnacipran (2013)

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

2655

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

1004

</td>

</tr>

<tr>

<td style="text-align:left;">

Vortioxetine (2013)

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

3060

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

1621

</td>

</tr>

</tbody>

</table>

The analysis is run on the sum of the above mentioned data:

<table>

<thead>

<tr>

<th style="text-align:left;">

</th>

<th style="text-align:right;">

Placebo

</th>

<th style="text-align:right;">

Antidepressant

</th>

</tr>

</thead>

<tbody>

<tr>

<td style="text-align:left;">

no suicide

</td>

<td style="text-align:right;">

10076

</td>

<td style="text-align:right;">

31744

</td>

</tr>

<tr>

<td style="text-align:left;">

suicide

</td>

<td style="text-align:right;">

4

</td>

<td style="text-align:right;">

37

</td>

</tr>

</tbody>

</table>

## Reproducing Hengartner et al. results

    ## $tab
    ##            Placebo           p0 Antidepressant          p1 oddsratio
    ## no suicide   10076 0.9996031746          31744 0.998835782   1.00000
    ## suicide          4 0.0003968254             37 0.001164218   2.83487
    ##               lower    upper    p.value
    ## no suicide       NA       NA         NA
    ## suicide    1.133143 9.671619 0.02354558
    ## 
    ## $measure
    ## [1] "midp"
    ## 
    ## $conf.level
    ## [1] 0.95
    ## 
    ## $pvalue
    ## [1] "midp.exact"
    ## 
    ## $x
    ##            Placebo Antidepressant
    ## no suicide   10076          31744
    ## suicide          4             37
    ## 
    ## $data
    ##            Placebo Antidepressant Total
    ## no suicide   10076          31744 41820
    ## suicide          4             37    41
    ## Total        10080          31781 41861
    ## 
    ## $p.exposed
    ##                 Placebo Antidepressant        Total
    ## no suicide 0.9996031746    0.998835782 0.9990205681
    ## suicide    0.0003968254    0.001164218 0.0009794319
    ## Total      1.0000000000    1.000000000 1.0000000000
    ## 
    ## $p.outcome
    ##               Placebo Antidepressant Total
    ## no suicide 0.24093735      0.7590626     1
    ## suicide    0.09756098      0.9024390     1
    ## Total      0.24079692      0.7592031     1
    ## 
    ## $p.value
    ##             NA
    ## two-sided    midp.exact fisher.exact chi.square
    ##   no suicide         NA           NA         NA
    ##   suicide    0.02354558   0.02855102 0.04960071
    ## 
    ## $correction
    ## [1] TRUE

First one has to visualize the data.

## Mosaic plot

![](antidepressants_markd_files/figure-gfm/mosaic-1.png)<!-- -->

Then we reanalyzed the data using meta analytical approach taking the
variance between studies into account peto method
<http://www.metafor-project.org/doku.php/analyses:yusuf1985>

### suicide

![](antidepressants_markd_files/figure-gfm/forest-1.png)<!-- -->

### suicide attempts

![](antidepressants_markd_files/figure-gfm/forest_attempt_plot-1.png)<!-- -->![](antidepressants_markd_files/figure-gfm/forest_attempt_plot-2.png)<!-- -->

### suicide

Mantel-Haenszel (MH) Methode. Reccomended for rare events, and anequal
group sizes: Ref:
<https://ebmh.bmj.com/content/21/2/72>

![](antidepressants_markd_files/figure-gfm/metafor_suicide-1.png)<!-- -->

    ## 
    ## Fixed-Effects Model (k = 14)
    ## 
    ## Test for Heterogeneity: 
    ## Q(df = 7) = 4.9623, p-val = 0.6646
    ## 
    ## Model Results (log scale):
    ## 
    ## estimate      se    zval    pval    ci.lb   ci.ub 
    ##   0.6828  0.5211  1.3103  0.1901  -0.3386  1.7042 
    ## 
    ## Model Results (OR scale):
    ## 
    ## estimate   ci.lb   ci.ub 
    ##   1.9794  0.7128  5.4968 
    ## 
    ## Cochran-Mantel-Haenszel Test:    CMH = 1.8312, df = 1, p-val = 0.1760
    ## Tarone's Test for Heterogeneity: X^2 = 7.5084, df = 7, p-val = 0.3779

### suicide attempts

![](antidepressants_markd_files/figure-gfm/metafor_suicideattempts-1.png)<!-- -->

    ## 
    ## Fixed-Effects Model (k = 12)
    ## 
    ## Test for Heterogeneity: 
    ## Q(df = 11) = 6.3883, p-val = 0.8462
    ## 
    ## Model Results (log scale):
    ## 
    ## estimate      se    zval    pval   ci.lb   ci.ub 
    ##   0.4901  0.2038  2.4053  0.0162  0.0907  0.8895 
    ## 
    ## Model Results (OR scale):
    ## 
    ## estimate   ci.lb   ci.ub 
    ##   1.6325  1.0950  2.4340 
    ## 
    ## Cochran-Mantel-Haenszel Test:    CMH =  5.9428, df = 1,  p-val = 0.0148
    ## Tarone's Test for Heterogeneity: X^2 = 10.4092, df = 11, p-val = 0.4940

![](antidepressants_markd_files/figure-gfm/metafor_suicideattempts-2.png)<!-- -->

calculating NNH with
<https://ebm-tools.knowledgetranslation.net/calculator/converter/>

patient expected event rate of 3.7% according to

<https://www.cdc.gov/mmwr/preview/mmwrhtml/ss6013a1.htm>

NNH=45

Or from risk difference according to
<https://handbook-5-1.cochrane.org/chapter_12/12_5_4_1_computing_nnt_from_a_risk_difference_rd.htm>

``` r
res <-rma.mh(df$suica_ad, df$part_ad-df$suica_ad, 
       df$suica_plc, df$part_plc-df$suica_plc, 
       df$part_ad, df$part_plc,
       to="only0", drop00=FALSE, add=1/2,
       level=95, verbose=FALSE, measure="RD", correct = FALSE)
res
```

    ## 
    ## Fixed-Effects Model (k = 12)
    ## 
    ## Test for Heterogeneity: 
    ## Q(df = 11) = 12.4491, p-val = 0.3309
    ## 
    ## Model Results:
    ## 
    ## estimate      se    zval    pval   ci.lb   ci.ub 
    ##   0.0021  0.0007  2.7588  0.0058  0.0006  0.0035

### NNH

``` r
1/0.0021
```

    ## [1] 476.1905

### age effect

In the original of the FDA data Stone et al. describe a strong age
effect.

## reanalyzing Khan et al. with patient exposure year (PEY)

<table>

<thead>

<tr>

<th style="text-align:right;">

year

</th>

<th style="text-align:left;">

medication

</th>

<th style="text-align:right;">

NAD

</th>

<th style="text-align:right;">

PEYAD

</th>

<th style="text-align:right;">

NPLC

</th>

<th style="text-align:right;">

PEYPLC

</th>

<th style="text-align:right;">

ADSuicide

</th>

<th style="text-align:right;">

PlaceboSuicide

</th>

<th style="text-align:right;">

ADSuicideattempt

</th>

<th style="text-align:right;">

PlaceboSuicideattempt

</th>

</tr>

</thead>

<tbody>

<tr>

<td style="text-align:right;">

1991

</td>

<td style="text-align:left;">

Sertraline

</td>

<td style="text-align:right;">

2053

</td>

<td style="text-align:right;">

507.9

</td>

<td style="text-align:right;">

786

</td>

<td style="text-align:right;">

209.0

</td>

<td style="text-align:right;">

2

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

9

</td>

<td style="text-align:right;">

5

</td>

</tr>

<tr>

<td style="text-align:right;">

1992

</td>

<td style="text-align:left;">

Paroxetine

</td>

<td style="text-align:right;">

2963

</td>

<td style="text-align:right;">

1008.0

</td>

<td style="text-align:right;">

554

</td>

<td style="text-align:right;">

72.0

</td>

<td style="text-align:right;">

5

</td>

<td style="text-align:right;">

2

</td>

<td style="text-align:right;">

40

</td>

<td style="text-align:right;">

6

</td>

</tr>

<tr>

<td style="text-align:right;">

1993

</td>

<td style="text-align:left;">

Venlafaxine

</td>

<td style="text-align:right;">

2181

</td>

<td style="text-align:right;">

879.0

</td>

<td style="text-align:right;">

451

</td>

<td style="text-align:right;">

100.0

</td>

<td style="text-align:right;">

3

</td>

<td style="text-align:right;">

1

</td>

<td style="text-align:right;">

NA

</td>

<td style="text-align:right;">

NA

</td>

</tr>

<tr>

<td style="text-align:right;">

1994

</td>

<td style="text-align:left;">

Nefazodone

</td>

<td style="text-align:right;">

3496

</td>

<td style="text-align:right;">

1018.0

</td>

<td style="text-align:right;">

875

</td>

<td style="text-align:right;">

204.0

</td>

<td style="text-align:right;">

9

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

12

</td>

<td style="text-align:right;">

1

</td>

</tr>

<tr>

<td style="text-align:right;">

1996

</td>

<td style="text-align:left;">

Mirtazapine

</td>

<td style="text-align:right;">

2425

</td>

<td style="text-align:right;">

671.7

</td>

<td style="text-align:right;">

494

</td>

<td style="text-align:right;">

71.4

</td>

<td style="text-align:right;">

8

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

29

</td>

<td style="text-align:right;">

3

</td>

</tr>

<tr>

<td style="text-align:right;">

1997

</td>

<td style="text-align:left;">

Venlafaxine ER

</td>

<td style="text-align:right;">

705

</td>

<td style="text-align:right;">

161.6

</td>

<td style="text-align:right;">

285

</td>

<td style="text-align:right;">

42.4

</td>

<td style="text-align:right;">

1

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

NA

</td>

<td style="text-align:right;">

NA

</td>

</tr>

<tr>

<td style="text-align:right;">

1998

</td>

<td style="text-align:left;">

Citalopram

</td>

<td style="text-align:right;">

4168

</td>

<td style="text-align:right;">

1347.7

</td>

<td style="text-align:right;">

691

</td>

<td style="text-align:right;">

150.3

</td>

<td style="text-align:right;">

8

</td>

<td style="text-align:right;">

1

</td>

<td style="text-align:right;">

91

</td>

<td style="text-align:right;">

10

</td>

</tr>

<tr>

<td style="text-align:right;">

2002

</td>

<td style="text-align:left;">

Escitalopram

</td>

<td style="text-align:right;">

715

</td>

<td style="text-align:right;">

99.0

</td>

<td style="text-align:right;">

592

</td>

<td style="text-align:right;">

83.0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

4

</td>

<td style="text-align:right;">

0

</td>

</tr>

<tr>

<td style="text-align:right;">

2002

</td>

<td style="text-align:left;">

Duloxetine

</td>

<td style="text-align:right;">

2314

</td>

<td style="text-align:right;">

754.0

</td>

<td style="text-align:right;">

723

</td>

<td style="text-align:right;">

NA

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

7

</td>

<td style="text-align:right;">

0

</td>

</tr>

<tr>

<td style="text-align:right;">

2008

</td>

<td style="text-align:left;">

Desvenlafaxine

</td>

<td style="text-align:right;">

2667

</td>

<td style="text-align:right;">

1137.2

</td>

<td style="text-align:right;">

803

</td>

<td style="text-align:right;">

112.8

</td>

<td style="text-align:right;">

1

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

4

</td>

<td style="text-align:right;">

1

</td>

</tr>

<tr>

<td style="text-align:right;">

2010

</td>

<td style="text-align:left;">

Trazodone ER

</td>

<td style="text-align:right;">

202

</td>

<td style="text-align:right;">

25.9

</td>

<td style="text-align:right;">

204

</td>

<td style="text-align:right;">

28.8

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

1

</td>

</tr>

<tr>

<td style="text-align:right;">

2011

</td>

<td style="text-align:left;">

Vilazodone

</td>

<td style="text-align:right;">

2177

</td>

<td style="text-align:right;">

551.5

</td>

<td style="text-align:right;">

997

</td>

<td style="text-align:right;">

136.1

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

1

</td>

<td style="text-align:right;">

3

</td>

<td style="text-align:right;">

1

</td>

</tr>

<tr>

<td style="text-align:right;">

2013

</td>

<td style="text-align:left;">

Levomilnacipran

</td>

<td style="text-align:right;">

2655

</td>

<td style="text-align:right;">

899.5

</td>

<td style="text-align:right;">

NA

</td>

<td style="text-align:right;">

NA

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

4

</td>

<td style="text-align:right;">

0

</td>

</tr>

<tr>

<td style="text-align:right;">

2013

</td>

<td style="text-align:left;">

Vortioxetine

</td>

<td style="text-align:right;">

3060

</td>

<td style="text-align:right;">

406.3

</td>

<td style="text-align:right;">

1621

</td>

<td style="text-align:right;">

213.4

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

0

</td>

<td style="text-align:right;">

3

</td>

<td style="text-align:right;">

0

</td>

</tr>

</tbody>

</table>

### suicide

    ## 
    ## Random-Effects Model (k = 12; tau^2 estimator: REML)
    ## 
    ## tau^2 (estimated amount of total heterogeneity): 0 (SE = 0.7326)
    ## tau (square root of estimated tau^2 value):      0
    ## I^2 (total heterogeneity / total variability):   0.00%
    ## H^2 (total variability / sampling variability):  1.00
    ## 
    ## Test for Heterogeneity:
    ## Q(df = 11) = 7.0702, p-val = 0.7934
    ## 
    ## Model Results:
    ## 
    ## estimate      se     zval    pval    ci.lb   ci.ub 
    ##  -0.6047  0.3982  -1.5184  0.1289  -1.3851  0.1758    
    ## 
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

![](antidepressants_markd_files/figure-gfm/metafor_Khan_suicide-1.png)<!-- -->

### suicide attempts

    ## 
    ## Random-Effects Model (k = 10; tau^2 estimator: REML)
    ## 
    ## tau^2 (estimated amount of total heterogeneity): 0 (SE = 0.1581)
    ## tau (square root of estimated tau^2 value):      0
    ## I^2 (total heterogeneity / total variability):   0.00%
    ## H^2 (total variability / sampling variability):  1.00
    ## 
    ## Test for Heterogeneity:
    ## Q(df = 9) = 7.0107, p-val = 0.6360
    ## 
    ## Model Results:
    ## 
    ## estimate      se     zval    pval    ci.lb   ci.ub 
    ##  -0.1539  0.2046  -0.7522  0.4519  -0.5548  0.2471    
    ## 
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

![](antidepressants_markd_files/figure-gfm/metafor_Khan_suicideattempts-1.png)<!-- -->

Kahn et al. specifically report a reduction of suicide and suicide
attempts in newer studys. Probably confounded by more rigid exclusion
criteria of suicidal patients in newer studies.

Problem with PEY: if suicide attemts occur causally after treatment
initiation than PEY will water down effect.

# for supplement

### R Code adopted from Efthimiou(1)

Data is stored in table “antidepressants\_suicideattempt.xls” and
“antidepressants\_suicide.xls”. Start by installing necessary
libraries

    ## Loading 'meta' package (version 4.9-5).
    ## Type 'help(meta)' for a brief overview.

    ## 
    ## Attaching package: 'meta'

    ## The following objects are masked from 'package:metafor':
    ## 
    ##     baujat, forest, funnel, funnel.default, labbe, radial,
    ##     trimfill

## for suicide

### Perform the analyses

``` r
# inverse-variance odds-ratio with 0.5 continuity correction

OR.IV <- metabin(y1, n1, y2, n2, sm="OR", method = "Inverse", incr=0.5)
print(summary(OR.IV), digits=2)
```

    ## Number of studies combined: k = 8
    ## 
    ##                        OR       95%-CI    z p-value
    ## Fixed effect model   1.09 [0.46; 2.58] 0.19  0.8456
    ## Random effects model 1.09 [0.46; 2.58] 0.19  0.8456
    ## 
    ## Quantifying heterogeneity:
    ## tau^2 = 0; H = 1.00 [1.00; 1.17]; I^2 = 0.0% [0.0%; 27.2%]
    ## 
    ## Test of heterogeneity:
    ##     Q d.f. p-value
    ##  3.12    7  0.8739
    ## 
    ## Details on meta-analytical method:
    ## - Inverse variance method
    ## - DerSimonian-Laird estimator for tau^2
    ## - Continuity correction of 0.5 in studies with zero cell frequencies

``` r
# inverse-variance odds-ratio with “treatment-arm” continuity correction
OR.IV2 <- metabin(y1, n1, y2, n2, sm="OR", method = "Inverse", incr="TACC")
print(summary(OR.IV2), digits=2)
```

    ## Number of studies combined: k = 8
    ## 
    ##                        OR       95%-CI    z p-value
    ## Fixed effect model   1.11 [0.42; 2.90] 0.20  0.8392
    ## Random effects model 1.11 [0.42; 2.90] 0.20  0.8392
    ## 
    ## Quantifying heterogeneity:
    ## tau^2 = 0; H = 1.00 [1.00; 1.32]; I^2 = 0.0% [0.0%; 42.8%]
    ## 
    ## Test of heterogeneity:
    ##     Q d.f. p-value
    ##  3.97    7  0.7835
    ## 
    ## Details on meta-analytical method:
    ## - Inverse variance method
    ## - DerSimonian-Laird estimator for tau^2
    ## - Treatment arm continuity correction in studies with zero cell frequencies

``` r
# Peto odds-ratio fixed effects
MH.Peto <- metabin(y1, n1, y2, n2, sm="OR", method = "Peto")
print(summary(MH.Peto), digits=2)
```

    ## Number of studies combined: k = 8
    ## 
    ##                        OR       95%-CI    z p-value
    ## Fixed effect model   1.74 [0.78; 3.90] 1.35  0.1760
    ## Random effects model 1.74 [0.78; 3.90] 1.35  0.1760
    ## 
    ## Quantifying heterogeneity:
    ## tau^2 = 0; H = 1.00 [1.00; 1.43]; I^2 = 0.0% [0.0%; 51.1%]
    ## 
    ## Test of heterogeneity:
    ##     Q d.f. p-value
    ##  4.64    7  0.7032
    ## 
    ## Details on meta-analytical method:
    ## - Peto method
    ## - DerSimonian-Laird estimator for tau^2

``` r
# Mantel-Haenszel odds-ratio with no continuity correction fixed effects 
MH.OR <- metabin(y1, n1, y2, n2, sm="OR", MH.exact=TRUE)
print(summary(MH.OR), digits=2)
```

    ## Number of studies combined: k = 8
    ## 
    ##                        OR       95%-CI    z p-value
    ## Fixed effect model   1.98 [0.71; 5.50] 1.31  0.1901
    ## Random effects model 1.09 [0.46; 2.58] 0.19  0.8456
    ## 
    ## Quantifying heterogeneity:
    ## tau^2 = 0; H = 1.00 [1.00; 1.48]; I^2 = 0.0% [0.0%; 54.3%]
    ## 
    ## Test of heterogeneity:
    ##     Q d.f. p-value
    ##  4.96    7  0.6646
    ## 
    ## Details on meta-analytical method:
    ## - Mantel-Haenszel method (without continuity correction)
    ## - DerSimonian-Laird estimator for tau^2
    ## - Continuity correction of 0.5 in studies with zero cell frequencies

``` r
# Mantel-Haenszel odds-ratio with “treatment-arm” continuity correction for forest plot
MH.OR1 <- metabin(y1, n1, y2, n2, sm="OR", MH.exact=F, incr="TACC")
print(summary(MH.OR1), digits=2)
```

    ## Number of studies combined: k = 8
    ## 
    ##                        OR       95%-CI    z p-value
    ## Fixed effect model   1.78 [0.71; 4.42] 1.23  0.2169
    ## Random effects model 1.11 [0.42; 2.90] 0.20  0.8392
    ## 
    ## Quantifying heterogeneity:
    ## tau^2 = 0; H = 1.00 [1.00; 1.47]; I^2 = 0.0% [0.0%; 53.6%]
    ## 
    ## Test of heterogeneity:
    ##     Q d.f. p-value
    ##  4.90    7  0.6727
    ## 
    ## Details on meta-analytical method:
    ## - Mantel-Haenszel method
    ## - DerSimonian-Laird estimator for tau^2
    ## - Treatment arm continuity correction in studies with zero cell frequencies

``` r
# Mantel-Haenszel odds-ratio with 0.5 continuity correction not in table 
MH.OR2 <- metabin(y1, n1, y2, n2, sm="OR", MH.exact=F, incr=0.5)
print(summary(MH.OR2), digits=2)
```

    ## Number of studies combined: k = 8
    ## 
    ##                        OR       95%-CI    z p-value
    ## Fixed effect model   1.37 [0.60; 3.15] 0.75  0.4549
    ## Random effects model 1.09 [0.46; 2.58] 0.19  0.8456
    ## 
    ## Quantifying heterogeneity:
    ## tau^2 = 0; H = 1.00 [1.00; 1.22]; I^2 = 0.0% [0.0%; 33.1%]
    ## 
    ## Test of heterogeneity:
    ##     Q d.f. p-value
    ##  3.39    7  0.8463
    ## 
    ## Details on meta-analytical method:
    ## - Mantel-Haenszel method
    ## - DerSimonian-Laird estimator for tau^2
    ## - Continuity correction of 0.5 in studies with zero cell frequencies

``` r
# Mantel-Haenszel risk-difference with no continuity correction
MH.RD<- metabin(y1, n1, y2, n2, sm="RD", MH.exact=TRUE)
print(summary(MH.RD), digits=5)
```

    ## Number of studies combined: k = 14
    ## 
    ##                           RD              95%-CI    z p-value
    ## Fixed effect model   0.00045 [-0.00009; 0.00098] 1.63  0.1029
    ## Random effects model 0.00030 [-0.00025; 0.00085] 1.06  0.2887
    ## 
    ## Quantifying heterogeneity:
    ## tau^2 = 0; H = 1.00 [1.00; 1.22]; I^2 = 0.0% [0.0%; 32.8%]
    ## 
    ## Test of heterogeneity:
    ##     Q d.f. p-value
    ##  8.70   13  0.7952
    ## 
    ## Details on meta-analytical method:
    ## - Mantel-Haenszel method (without continuity correction)
    ## - DerSimonian-Laird estimator for tau^2
    ## - Continuity correction of 0.5 in studies with zero cell frequencies

``` r
# Beta-binomial with correlated responses
B=data.frame(y1=y2,y2=y1,n1=n2,n2=n1)
B$studynames=suicide$study

Beta.Bin<-multipletables(data=B, measure="OR", model="Sarmanov", method="sampling", nsam=1000)
summary(Beta.Bin)
```

    ## Model: Sarmanov Beta-Binomial Model
    ## Overall Odds ratio
    ## Estimate: 2.271
    ## 95% CI:[1.083,4.759]
    ## 
    ## Maximum likelihood estimates of hyperparameters:
    ## a1 =0.393, b1 =840.495, a2 =0.856, b2 =806.095, rho =0
    ## Likelihood ratio test for within-group correlation (H0: rho=0):
    ## chi2: 0.001; p-value: 0.97
    ## Study-SpecifcOdds ratio:
    ##                         Mean Lower Bound Upper Bound
    ## Sertraline (1991)      1.000       1.000       1.000
    ## Paroxetine (1992)      1.000       1.000       1.000
    ## Venlafaxine (1993)     1.000       1.000       1.000
    ## Nefazodone (1994)      1.000       1.000       1.000
    ## Mirtazapine (1996)     1.000       1.000       1.000
    ## Venlafaxine ER (1997)  1.000       1.000       1.000
    ## Citalopram (1998)      1.000       1.000       1.000
    ## Escitalopram (2002)    1.000       1.000       1.000
    ## Duloxetine (2002)      1.000       1.000       1.000
    ## Desvenlafaxine (2008)  1.000       1.000       1.000
    ## Trazodone ER (2010)    1.000       1.000       1.000
    ## Vilazodone (2011)      1.000       1.000       1.000
    ## Levomilnacipran (2013) 1.000       1.000       1.000
    ## Vortioxetine (2013)    1.000       1.000       1.000
    ## Overall                2.271       1.083       4.759

``` r
# Arcsine difference fixed effect model
ASD <- metabin(y1, n1, y2, n2, sm="ASD")
print(summary(ASD), digits=3)
```

    ## Number of studies combined: k = 14
    ## 
    ##                        ASD         95%-CI    z p-value
    ## Fixed effect model   0.012 [0.000; 0.023] 2.03  0.0422
    ## Random effects model 0.012 [0.000; 0.024] 1.98  0.0479
    ## 
    ## Quantifying heterogeneity:
    ## tau^2 < 0.0001; H = 1.03 [1.00; 1.53]; I^2 = 5.2% [0.0%; 57.4%]
    ## 
    ## Test of heterogeneity:
    ##      Q d.f. p-value
    ##  13.71   13  0.3948
    ## 
    ## Details on meta-analytical method:
    ## - Inverse variance method
    ## - DerSimonian-Laird estimator for tau^2

## plots

![](antidepressants_markd_files/figure-gfm/unnamed-chunk-4-1.png)<!-- -->![](antidepressants_markd_files/figure-gfm/unnamed-chunk-4-2.png)<!-- -->

## for suicide\_attempts:

### Perform the analyses

``` r
# inverse-variance odds-ratio with 0.5 continuity correction
library(meta)
OR.IV <- metabin(y1, n1, y2, n2, sm="OR", method = "Inverse", incr=0.5)
print(summary(OR.IV), digits=2)
```

    ## Number of studies combined: k = 12
    ## 
    ##                        OR       95%-CI    z p-value
    ## Fixed effect model   1.46 [0.98; 2.16] 1.87  0.0616
    ## Random effects model 1.46 [0.98; 2.16] 1.87  0.0616
    ## 
    ## Quantifying heterogeneity:
    ## tau^2 = 0; H = 1.00 [1.00; 1.15]; I^2 = 0.0% [0.0%; 24.5%]
    ## 
    ## Test of heterogeneity:
    ##     Q d.f. p-value
    ##  6.07   11  0.8684
    ## 
    ## Details on meta-analytical method:
    ## - Inverse variance method
    ## - DerSimonian-Laird estimator for tau^2
    ## - Continuity correction of 0.5 in studies with zero cell frequencies

``` r
# inverse-variance odds-ratio with “treatment-arm” continuity correction
OR.IV2 <- metabin(y1, n1, y2, n2, sm="OR", method = "Inverse", incr="TACC")
print(summary(OR.IV2), digits=2)
```

    ## Number of studies combined: k = 12
    ## 
    ##                        OR       95%-CI    z p-value
    ## Fixed effect model   1.45 [0.97; 2.17] 1.83  0.0677
    ## Random effects model 1.45 [0.97; 2.17] 1.83  0.0677
    ## 
    ## Quantifying heterogeneity:
    ## tau^2 = 0; H = 1.00 [1.00; 1.22]; I^2 = 0.0% [0.0%; 32.6%]
    ## 
    ## Test of heterogeneity:
    ##     Q d.f. p-value
    ##  6.81   11  0.8144
    ## 
    ## Details on meta-analytical method:
    ## - Inverse variance method
    ## - DerSimonian-Laird estimator for tau^2
    ## - Treatment arm continuity correction in studies with zero cell frequencies

``` r
# Peto odds-ratio fixed effects
MH.Peto <- metabin(y1, n1, y2, n2, sm="OR", method = "Peto")
print(summary(MH.Peto), digits=2)
```

    ## Number of studies combined: k = 12
    ## 
    ##                        OR       95%-CI    z p-value
    ## Fixed effect model   1.53 [1.09; 2.15] 2.44  0.0148
    ## Random effects model 1.53 [1.09; 2.15] 2.44  0.0148
    ## 
    ## Quantifying heterogeneity:
    ## tau^2 = 0; H = 1.00 [1.00; 1.37]; I^2 = 0.0% [0.0%; 46.7%]
    ## 
    ## Test of heterogeneity:
    ##     Q d.f. p-value
    ##  8.60   11  0.6586
    ## 
    ## Details on meta-analytical method:
    ## - Peto method
    ## - DerSimonian-Laird estimator for tau^2

``` r
# Mantel-Haenszel odds-ratio with no continuity correction fixed effects 
MH.OR <- metabin(y1, n1, y2, n2, sm="OR", MH.exact=TRUE)
print(summary(MH.OR), digits=2)
```

    ## Number of studies combined: k = 12
    ## 
    ##                        OR       95%-CI    z p-value
    ## Fixed effect model   1.63 [1.09; 2.43] 2.41  0.0162
    ## Random effects model 1.46 [0.98; 2.16] 1.87  0.0616
    ## 
    ## Quantifying heterogeneity:
    ## tau^2 = 0; H = 1.00 [1.00; 1.18]; I^2 = 0.0% [0.0%; 28.2%]
    ## 
    ## Test of heterogeneity:
    ##     Q d.f. p-value
    ##  6.39   11  0.8462
    ## 
    ## Details on meta-analytical method:
    ## - Mantel-Haenszel method (without continuity correction)
    ## - DerSimonian-Laird estimator for tau^2
    ## - Continuity correction of 0.5 in studies with zero cell frequencies

``` r
# Mantel-Haenszel odds-ratio with “treatment-arm” continuity correction for forest plot
MH.OR1 <- metabin(y1, n1, y2, n2, sm="OR", MH.exact=F, incr="TACC")
print(summary(MH.OR1), digits=2)
```

    ## Number of studies combined: k = 12
    ## 
    ##                        OR       95%-CI    z p-value
    ## Fixed effect model   1.60 [1.09; 2.37] 2.37  0.0177
    ## Random effects model 1.45 [0.97; 2.17] 1.83  0.0677
    ## 
    ## Quantifying heterogeneity:
    ## tau^2 = 0; H = 1.00 [1.00; 1.24]; I^2 = 0.0% [0.0%; 34.9%]
    ## 
    ## Test of heterogeneity:
    ##     Q d.f. p-value
    ##  7.04   11  0.7957
    ## 
    ## Details on meta-analytical method:
    ## - Mantel-Haenszel method
    ## - DerSimonian-Laird estimator for tau^2
    ## - Treatment arm continuity correction in studies with zero cell frequencies

``` r
# Mantel-Haenszel odds-ratio with 0.5 continuity correction not in table 
MH.OR2 <- metabin(y1, n1, y2, n2, sm="OR", MH.exact=F, incr=0.5)
print(summary(MH.OR2), digits=2)
```

    ## Number of studies combined: k = 12
    ## 
    ##                        OR       95%-CI    z p-value
    ## Fixed effect model   1.56 [1.06; 2.30] 2.26  0.0238
    ## Random effects model 1.46 [0.98; 2.16] 1.87  0.0616
    ## 
    ## Quantifying heterogeneity:
    ## tau^2 = 0; H = 1.00 [1.00; 1.16]; I^2 = 0.0% [0.0%; 25.9%]
    ## 
    ## Test of heterogeneity:
    ##     Q d.f. p-value
    ##  6.19   11  0.8604
    ## 
    ## Details on meta-analytical method:
    ## - Mantel-Haenszel method
    ## - DerSimonian-Laird estimator for tau^2
    ## - Continuity correction of 0.5 in studies with zero cell frequencies

``` r
# Mantel-Haenszel risk-difference with no continuity correction
MH.RD<- metabin(y1, n1, y2, n2, sm="RD", MH.exact=TRUE)
print(summary(MH.RD), digits=5)
```

    ## Number of studies combined:   k.MH = 14 (fixed effect), k = 12 (random effects)
    ## 
    ##                           RD             95%-CI    z p-value
    ## Fixed effect model   0.00206 [0.00073; 0.00340] 3.03  0.0024
    ## Random effects model 0.00139 [0.00043; 0.00236] 2.83  0.0046
    ## 
    ## Quantifying heterogeneity:
    ## tau^2 < 0.0001; H = 1.04 [1.00; 1.61]; I^2 = 7.4% [0.0%; 61.4%]
    ## 
    ## Test of heterogeneity:
    ##      Q d.f. p-value
    ##  11.88   11  0.3731
    ## 
    ## Details on meta-analytical method:
    ## - Mantel-Haenszel method (without continuity correction)
    ## - DerSimonian-Laird estimator for tau^2
    ## - Continuity correction of 0.5 in studies with zero cell frequencies

``` r
# Beta-binomial with correlated responses
B=data.frame(y1=y2,y2=y1,n1=n2,n2=n1)
B$studynames=suicide_attempt$study

#Beta.Bin<-multipletables(data=B, measure="OR", model="Sarmanov", method="sampling", nsam=1000)
#summary(Beta.Bin)
```

``` r
# Arcsine difference fixed effect model
ASD <- metabin(y1, n1, y2, n2, sm="ASD")
print(summary(ASD), digits=3)
```

    ## Number of studies combined: k = 14
    ## 
    ##                        ASD         95%-CI    z p-value
    ## Fixed effect model   0.023 [0.012; 0.035] 3.87  0.0001
    ## Random effects model 0.023 [0.010; 0.036] 3.45  0.0006
    ## 
    ## Quantifying heterogeneity:
    ## tau^2 < 0.0001; H = 1.09 [1.00; 1.48]; I^2 = 16.2% [0.0%; 54.3%]
    ## 
    ## Test of heterogeneity:
    ##      Q d.f. p-value
    ##  15.51   13  0.2767
    ## 
    ## Details on meta-analytical method:
    ## - Inverse variance method
    ## - DerSimonian-Laird estimator for tau^2

## plots

![](antidepressants_markd_files/figure-gfm/unnamed-chunk-11-1.png)<!-- -->![](antidepressants_markd_files/figure-gfm/unnamed-chunk-11-2.png)<!-- -->

References:

1.  Efthimiou O. Practical guide to the meta-analysis of rare events.
    Evid Based Ment Health. 2018;21(2):72–6.
2.  Bradburn MJ, Deeks JJ, Berlin JA, Localio AR. Much ado about
    nothing: A comparison of the performance of meta-analytical methods
    with rare events. Stat Med. 2007;26(1):53–77.
